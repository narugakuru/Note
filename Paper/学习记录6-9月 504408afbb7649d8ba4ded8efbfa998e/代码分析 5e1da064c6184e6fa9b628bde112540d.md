# 代码分析

Owner: hikari

解释下面的vb代码，重点解释对数据表w_nai00040做了什么处理

# w_nai00040

行号
累计次数分类
公积金区分
有无抽选CD
预备1

## NAYJ10303

检查从数据库表 `w_nai00040` 获取的数据

CheckDB函数，检查数据是否为空

如果为空，则记录日志并设置错误代码。

如果有数据，则调用 `Chk_w_nai00040` 方法，检查sTsumiKaikubun，sTsumiKinkubun，chusen_umu字段数据是否合法

打印已处理数据行数日志

## NAYJ10304

获取 `w_nai00040` 表中的 `chusen_umu` 字段数据，并将其作为参数用于更新 `w_moshikomi` 表中的相关记录

KoushinDB函数，查询`w_nai00040`表的chusen_umu字段，第0行转换为string赋值给变量sChusenUmu
连接查询w_moshikomi和m_boshu表，遍历判断m_boshu表tsumi_techo_4keta 是否为null

是null，抛出异常（募集要項マスタなし  異常終了）

不是null，使用sChusenUmu变量更新`moshikomi`表的sChusenKekka字段

打印更新记录日志