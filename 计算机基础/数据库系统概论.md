---
tags:
  - SQL
---

## 总体重点：
- 基础概念
- SQL查询
- 数据库安全性和完整性
- 关系范式
- 数据库设计
- 恢复技术和并发控制
- 系统架构
- 新技术概念

## 主要考点
- 关系代数语言
- SQL语言
- 完整性约束
- 函数依赖闭包F+（逻辑蕴含）
- 最小函数依赖（armstrong）
- E-R图

## 解题方法论

### 数据关系理论
#### 候选码算法
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230330174246.png)


#### 闭包（逻辑蕴含）
Armstrong公理推导
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230328153618.png)
#### XF+闭包的算法
通过X能推导出的所有属性，即X的闭包XF+
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230329102405.png)

#### 最小函数依赖判断
- 右部均为单属性
- 没有一个函数依赖被删除后，可由剩余的依赖集推导替代
- 对于左部含属性组的依赖，右部属性完全依赖于左部的属性组，左部没有多余属性

**具体解法：**
对依赖集U
1. 将右部属性全部拆解单一化
2. 尝试将每一个依赖去除得到F，然后检查依赖F能否推出U
3. 最小依赖集不唯一

#### 模式分解
无损连接分解，保持函数依赖

**证明分解**
1. 对每个属性值Ri,构建初始表，存在一个Ri可以推出所有属性组，则是无损分解
2. 对分解后的每张表列出函数依赖，看是否有缺失

![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230407204602.png)
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230407204625.png)


**分解算法**
1. 求出最小函数依赖集和候选码
2. 把不在F中的属性找出来，分成一类
3. 把左部相同的依赖合成一类
4. 若候选码没有出现在任意关系中，则选择一个候选码作为一类

**例题：**
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230330173908.png)

### 数据库设计
步骤
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230330202456.png)

#### 设计E-R图
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230330202630.png)
#### E-R图转化为表结构
- 实体转化为一张表
- 联系
	- 1对1转化为主码
	- 1对多转化为外码
	- 多对多转化为一张表

#### 数据字典
- 数据项
- 数据结构
- 数据流
- 数据存储
- 处理过程

#### 关系代数查询树优化

![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230330205112.png)

#### 并发控制
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230330212702.png)

#### 大概率不考的题型、
- 嵌入式SQL
- 存储过程SQL
- B+树的索引开销计算


## 一、绪论

- 数据库系统基本概念
- 数据模型的三个组成
- 三层模型和两级映像
- 数据库系统架构及组成

[数据库的数据独立性和物理独立性是由DBMS的二级映像功能来实现的](https://zhidao.baidu.com/question/1962726583406131100.html)[1](https://zhidao.baidu.com/question/1962726583406131100.html)[。当整个系统要求改变模式时（增加记录类型、增加数据项），由DBMS对各个外模式/模式的映像做相应改变，从而保证了数据的逻辑独立性。当数据的存储结构改变时，由DBMS对模式/内模式的映像做相应改变，从而保证了数据的物理独立性](https://zhidao.baidu.com/question/1962726583406131100.html)[1](https://zhidao.baidu.com/question/1962726583406131100.html)[2](https://zhidao.baidu.com/question/573605356.html)

## 二、关系数据库

- 三类完整性约束
	- 实体完整性（主码必存在）
	- 关系完整性（外码必存在）
	- 参照完整性（外码为null或已存在的数据）
	- 用户定义的完整性
- 关系数据库查询语言
	- 关系代数语言
	- 关系演算语言
	- 双重特点的SQL
- 关系代数
	- 集合运算
	- 关系运算概念：分量，属性组，连接串接，象集
		- 象集的本质是选择X列的一个值然后投影其他列
	- 关系运算：选择，投影，连接（内，外，自然连接），**除运算**
		- 除运算（R÷S=T），只留下R有S没有的列(消除R中和S相同的属性列，取R、S共有列的象集）
		- 简单来说，就是提取R中能够和S匹配的元组，并去掉和S中相同的属性。
		- A,B(R)÷B(S)代表取R,S关系中B列相同的行；**即当R.B=S.B时，取R.A，去重**
	- **基础关系运算：选择，投影，并，差，笛卡尔积。其他运算可有5个基础运算组成**
- 关系范式

#### 问题
一个4列的关系R（A,B,C,D）和一个5列的关系S(C,D,E,F,G)，它们的交，并，查是什么结果？

## 三、SQL

- SQL的基本概念和特点
- SQL的三级模式，视图——基本表——存储文件
- 数据定义
	- 模式定义（数据库）SCHEMA
	- 表定义 TABLE
	- 数据类型
	- 索引！
- 数据查询
	- 基础单表查询
		- WHERE的常用条件
			- BETWEEN是取闭区间
			- 字符匹配-模糊查询
				- %表示任意个字符
				- ＿表示单个字符
				- LIKE '匹配字符'
		- ORDER BY排序
			- ASC升序DESC降序，ascend，descend
			- 可在GROUP BY后加入排序
		- 聚合函数
			- COUNT,SUM,AVG,MAX,MIN
		- GROUP BY和HAVING
			- HAVING必需在GROUP BY后面
			- HAVING可以使用聚合函数，而WHERE不行
			- HAVING作用于组，而WHERE作用于视图或表
	- 连接查询
		- 等值、非等值连接
		- 自身连接
		- 左右外连接
		- 多表连接
	- 嵌套查询
		- 相关、非相关子查询
		- 语句执行顺序

#### 查询操作
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230309212103.png)


## 四、数据库安全
- 用户身份鉴别
- 存取控制技术
	- DAC自主存取控制
	- MAC强制存钱控制
		- 敏感度标记
			- 客体：密级
			- 主体：许可证等级
- 视图技术
- 审计技术
- 数据加密
	- 存储加密
		- 内核透明加密
		- 函数不透明加密
	- 传输加密
		- 链路加密
		- 端到端加密




#### 审计
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230317202606.png)

#### 问题

数据库安全性问题？

	数据库安全性问题是指在数据库中存储、处理和传输数据时，存在未经授权的访问、篡改、泄露或破坏等安全威胁的情况。这些威胁可能来自内部或外部攻击者，如黑客、病毒、恶意软件等。数据库安全性问题可能导致敏感数据被窃取、泄露或篡改，从而对个人、组织或国家造成重大损失。为确保数据库安全性，需要采取一系列措施，如加密、访问控制、审计等。
  
以下是DBMS实现数据库安全性控制的常用方法和技术：

1.  访问控制：通过权限管理，限制用户对数据库的访问和操作，避免未经授权的访问和操作。
2.  数据加密：通过对敏感数据进行加密，确保数据在传输和存储过程中不被窃取、篡改或泄露。
3.  审计跟踪：记录数据库中的操作行为，包括用户登录、数据操作等，以便及时发现异常行为和安全威胁。
4.  数据备份和恢复：对数据库进行定期备份，以防止数据丢失或损坏，并能够快速恢复数据。
5.  强密码策略：要求用户设置复杂的密码，并定期更改密码，以避免密码被猜测或破解。
6.  防火墙：设置防火墙，限制外部网络对数据库的访问，避免网络攻击。
7.  漏洞扫描和修复：定期对数据库进行漏洞扫描和修复，以防止已知的安全漏洞被攻击者利用。
8.  日志管理：对数据库的日志进行管理，及时发现异常行为和安全事件。

## 五、数据完整性
#### 本章目标
![](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230321223043.png)


#### 数据库完整性概念
- 完整性控制机制
	- 定义机制
		- SQL实现
	- 检查机制
		- 执行SQL后检查
	- 违约机制
		- 拒绝
		- 级联
- 实体完整性
	- 定义方法
		- 多属性主码必须为表级约束
	- 检查方法及违约处理
		- 全表扫描（B+树实现）
- 参照完整性
	- 主码值不为空且唯一
	- 外码值为空或已存在的码
	- 违约处理
		- 需要在表级约束中定义
		- 拒绝NO ACTION
		- 级联CASCADE
		- 设置为空SET-NULL
- 用户定义的完整性
	- 属性约束和元组约束
	- CHECK(子句)
	- 检查时机和违约处理

#### 完整性约束SQL
- 完整性约束命名CONSTRAIND
	- 定义在属性或表级的完整性约束，仅单表
	- 违反规则，拒绝执行
- 断言ASSERTION
	- 比完整性约束子句更加复杂和灵活，可涉及多个表或聚集操作的完整性约束
	- 违反规则，拒绝执行
- 触发器TRIGGER
	- 事件驱动，只有当某事发生生才执行
	- 语句触发器，行级触发器
	- 触发事件-触发条件-触发动作


```sql

创建表时添加约束
CREATE TABLE people(
pno int,
no int,
work_time date,
CONSTRAINT c1 CHECK ( no IN (SELECT no FROM people 
GROUP BY no WHERE count(*)<=3) )
)
后面添加约束
ALTER TABLE table_name ADD/DROP PRIMARY KEY(colum_name);
添加命名约束
ALTER TABLE table_name 
ADD/DROP [CONSTRAINT constraint_name] PRIMARY KEY(colum_name);

添加断言
断言不同与约束，不需要针对某张表，直接创建即可
CREATE ASSERTION assertion_name CHECK (condition);

添加触发器
我们希望在向该表中插入新行时，自动计算订单总价，并将其存储到另一个名为 "order_total" 的列中。
CREATE TRIGGER calculate_order_total 
AFTER INSERT [ OF 属性名 ] ON orders 表和属性
[ FOR EACH RAW/TABLE ] AS 行级、表级
BEGIN 
UPDATE orders 
SET order_total = order_price * order_quantity 
WHERE order_id IN ( SELECT order_id FROM inserted ) 
END;
```

#### 安全性和完整性区分
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230317203605.png)

#### 参照完整性违约处理
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230317204910.png)

#### 约束命名
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230322204632.png)

#### 触发器
![](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230321223253.png)

#### 完整性检查和违约处理
![](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230320210608.png)

#### 断言和完整性约束的区别
在数据库理论中，断言和完整性约束都是用于保证数据的一致性和正确性。

断言是一种在数据库中定义一个条件的方式，它表示了一个表达式必须为真，否则会抛出一个错误。这些错误信息通常显示给用户，以便他们在必要时进行纠正。断言可以应用于一整个表，也可以只应用于一个特定的列。

完整性约束是定义在表上的规则，用于限制插入、更新、删除操作。这些约束通常被设计为在数据库中保持数据的正确性和完整性。例如，可以定义一个唯一性约束，以保证每行记录的一个或多个列包含唯一的值。还可以定义一个外键约束，以确保在将外键与主键进行连接时，只能使用同一值。

因此，从定义和功能来看，断言和完整性约束是有明显的区别的。断言是一种单独定义一个条件的方式，用于验证数据的一个或多个表达式是否满足给定的条件。而完整性约束是一种在表层面上定义规则的方式，用于在数据库中维护数据的正确性和完整性。

## 总结
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230322214530.png)


## 六、数据关系理论
#### 考点方法论
- 求出候选码
- 闭包（逻辑蕴含），Armstrong公理推导
- 最小函数依赖判断
	- 右部均为单属性
	- 没有一个函数依赖被删除后，可由剩余的依赖集推导替代
	- 对于左部含属性组的依赖，右部属性完全依赖于左部的属性组，左部没有多余属性
- 无损连接分解，保持函数依赖
	- 证明
		- 构建初始属性覆盖表，若有一行全a，则是无损分解
		- 对分解后的每张表列出函数依赖，看是否有缺失
	- 分解算法
		- 某一张表需要含有原表的主码

**概念**
- 关系理论解决什么问题
	- 数据冗余，数据插入删除异常，数据依赖的安全问题
- 平凡、非平凡函数依赖
	- X->Y，Y是X的真子集，即平凡的函数依赖，没有探讨价值
- 完全函数依赖F，部分函数依赖P 
- 传递函数依赖
- 码
	- 候选码、主码
		- 主属性和非主属性（被任意一个候选码包含）
		- 主码是人选中并使用的候选码
		- 最小的超码
	- 超码，冗余的候选码，可推出所有属性
	- 全码，全部属性都是码，满足BCNF
	- 外码

**范式**
- 1NF，每个属性列是不可分的
- 2NF，每个**非主属性**完全依赖于主码，消除部分函数依赖
- 3NF，消除**非主属性**的传递函数依赖，所有**非主属性**唯一依赖于主码
	- R(S,T,J)所有属性都是主属性，**主属性**是部分依赖于主码的
	- (S,J)->T符合3NF，但存在**主属性**的部分函数依赖
- BCNF，没有任何一个属性部分依赖于主码，**主属性**也完全依赖于主码
- 4NF，消除非平凡、非函数的多值依赖
- 5NF，消除连接依赖

**数据依赖的公理系统**
- 用途
	- 求主码，证明逻辑蕴含
- F逻辑蕴含X->Y
- armstrong公理
- 函数依赖F的闭包
	- F中关于函数依赖的全体
- 属性X关于F的闭包
	- 在F依赖集下，通过X能推导出的所有属性，即X的闭包XF+
- 闭包引理用途
	- 将逻辑蕴含的证明转化为求XF+的过程
	- 将求主码X的证明，转化为求XF+
- XF+算法
- 依赖集等价\==闭包等价
- 最小依赖集

**模式分解**
- 分解具有无损连接，不丢失信息
- 分级要保持函数依赖，不产生CURD等异常
- 判别保持无损连接p192，自然连接成立
- 判别保持函数依赖p193


#### 非平凡函数依赖
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230327230407.png)

#### BCNF
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230328150313.png)

![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230328150645.png)


#### 规范化过程

消除多值依赖达到4NF
消除连接依赖达到5NF

![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230328150830.png)

#### 数据依赖的公理系统
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230328152849.png)

#### armstrong公理系统
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230328153618.png)

#### 函数依赖闭包
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230328165102.png)

#### 闭包的引理
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230328165706.png)

#### XF+闭包的算法
通过X能推导出的所有属性，即X的闭包XF+
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230329102405.png)

#### 最小函数依赖
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230329105719.png)
例题
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230329115200.png)

#### 模式分解算法
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230329124153.png)
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230329124240.png)
准则与标准
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230329124606.png)


## 七、数据库设计

**基本步骤**
1. 需求分析
2. 概念结构设计
	- ER图、数据字典
3. 逻辑结构设计
	- ER图转化为逻辑模型
4. 物理结构设计
	- 逻辑模型转化为物理模型
5. 数据库实施
	- 写SQL
6. 数据库运行和维护
	- 性能检测、转储、恢复

- 常见存取方法
	- 索引
	- 聚簇
	- Hash
- 数据设计方法
	- ER模型
	- 3NF
	- 面向对象
	- 新奥尔良方法
	- UML
- 集成局部ER图
	- 合并
	- 修改重构

## 八、数据库编程

- 嵌入式SQL
- 过程SQL
- 存储过程procedure（类似函数）
- 函数
- ODBC编程

## 九、关系查询和优化
优先进行选择和投影，最后连接

![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230330204501.png)


## 十、数据库恢复技术

#### 事务的四个特性

数据库事务具有以下四个特性，通常被称为ACID特性：
1.  原子性（Atomicity）：事务是一个原子操作，要么全部执行，要么全部回滚。如果事务执行过程中出现错误，系统会自动回滚到事务开始前的状态，保证数据的一致性。
2.  一致性（Consistency）：事务执行前和执行后，数据的状态应该保持一致。在事务执行过程中，如果出现了错误，系统会自动回滚到事务开始前的状态，保证数据的一致性。
3.  隔离性（Isolation）：事务之间是相互隔离的，每个事务都应该看到一个独立的数据视图。即使多个事务同时访问同一数据，也不会相互干扰。隔离级别越高，越能保证数据的一致性，但是也会增加系统的开销。
4.  持久性（Durability）：一旦事务提交，其所做的修改就应该永久保存在数据库中。即使系统发生故障或宕机，也不应该丢失已经提交的事务。为了保证持久性，系统通常会把修改记录在日志文件中，以便在系统恢复后重新执行事务。
综上所述，ACID特性是数据库事务的重要特性，它们保证了事务的正确性和可靠性，是数据库系统设计和实现的重要原则。

### 数据库的四类故障
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230330205239.png)

1.  事务故障：事务故障是指在数据库事务处理过程中，由于各种原因导致事务无法正常执行或提交，从而导致数据不一致或丢失。例如，当一个事务在执行过程中发生错误，如果没有正确处理，就可能导致该事务之前的操作无法回滚，或者之后的操作无法提交。
2.  系统故障：系统故障是指数据库管理系统本身出现的问题，例如软件错误、配置错误、网络故障等。这可能导致数据库无法正常工作，或者执行效率降低。
3.  介质故障：介质故障是指数据库存储介质（例如硬盘、磁带等）出现故障，导致数据丢失或不可用。例如，硬盘损坏、磁带磁性衰减等。
4.  运行故障：运行故障是指数据库运行过程中出现的问题，例如死锁、死循环、内存泄漏等。这些问题可能导致数据库无法响应、运行效率降低或崩溃。
在数据库管理中，需要对这些故障进行有效的预防和处理，以提高数据库的稳定性和可靠性。

#### 事务故障的处理

检查点---重做---系统故障----撤销
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230330212028.png)

## 十一、并发控制

并发
- 并发带来的问题
	- 丢失修改
	- 读脏数据
	- 不可重复读
- 解决方法
	- 排他锁，写锁，X锁
	- 共享锁，读锁，Share锁
- 三级封锁协议，对应三个问题
	- 一级封锁协议，解决**丢失修改**
		- 修改时，必须加X锁，直到结束
	- 二级封锁协议，解决**读脏数据**
		- 读的时候，加S锁，用完就放
	- 三级封锁协议，解决**不可重复读**
		- 读的时候，加S锁，直到结束

死锁和活锁
- 活锁，优先级低，一直拿不到资源
- 死锁，互相等待

可串行性
- 并发执行的结果和串行执行结果一致

封锁的粒度
- 粒度大，并发低，开销小
- 粒度细，并发高，开销大




# 补充知识点

### 关系模式
主属性：包含任意一个候选码中的某个或多个属性
关系模式五元组 R(U,D,DOM,F)
- U是一组属性
- D为属性组U中的属性所属的域
- DOM为属性到域的映射
- F为属性值U的函数依赖

### 关系范式
数据关系模式的所有范式包括以下几种：

1.  第一范式（1NF）：要求关系模式的每个属性都是原子的，即不可再分。换句话说，每个属性必须是单一值而不是多值的。
    
2.  第二范式（2NF）：要求关系模式必须满足第一范式，并且非主属性必须完全依赖于关系模式的主键，而**不是部分依赖于主键**。
    
3.  第三范式（3NF）：要求关系模式必须满足第二范式，并且**不存在传递依赖**。传递依赖是指非主属性依赖于其他非主属性的情况，例如关系模式R(A, B, C)，其中A是主键，B依赖于A，C依赖于B而不是A，这种情况就存在传递依赖。
    
4.  巴斯-科德范式（BCNF）：要求关系模式必须满足第三范式，**并且不存在非平凡的多值依赖和函数依赖**。平凡的多值依赖是指依赖于关系模式的主键，而非平凡的多值依赖是指依赖于关系模式中的其他属性。函数依赖是指属性A的取值唯一地决定属性B的取值。**所有属性唯一依赖于主键，不存在任何其他依赖。**
    **多值依赖X->Y,Z**
5.  第四范式（4NF）：要求关系模式必须满足BCNF，并且不存在非平凡的多值依赖。
    
6.  第五范式（5NF）：也称为投影联接范式（PJ/NF），要求关系模式必须满足第四范式，并且不存在联接依赖。

在实际数据库设计中，通常只需要满足前三范式即可。在设计高度规范化的数据库时，可以考虑使用更高级的范式，但需要根据具体的应用场景进行权衡和选择。

### 数据库设计

1.  需求分析：收集并分析用户的需求，确定数据库的目标和功能。
    
2.  概念设计：建立概念模型，包括实体、属性、关系等，用于描述数据库中的数据结构和关系。
    
3.  逻辑设计：根据概念模型，将其转化为数据库的逻辑结构，包括表、字段、约束等。
    
4.  物理设计：根据逻辑设计，将其转化为数据库实际存储的物理结构，包括表空间、数据文件、索引等。
    
5.  实现：根据物理设计，建立数据库并创建表、索引等对象。
    
6.  测试和维护：对数据库进行测试，发现并修复问题，同时进行日常维护和优化工作。
    

### 数据库关系模型设计  
数据库关系模型设计是指根据用户需求和数据特点，设计出适合的关系模型来存储和管理数据。以下是数据库关系模型设计的步骤：

1.  确定实体和属性：确定需要存储的实体和它们的属性，例如，一个学生实体可能有姓名、学号、性别、年龄等属性。
    
2.  确定实体之间的关系：根据实体之间的联系确定它们之间的关系，例如，学生和课程之间的关系是选课，学生和教师之间的关系是班级关系等。
    
3.  设计表结构：将实体和关系转化为表结构，每个表代表一个实体或关系，每个表包含若干列，每列代表一个属性。
    
4.  设计主键和外键：为每个表确定主键和外键，主键用于唯一标识表中的每一行数据，外键用于表之间的关联。
    
5.  规范化：对表结构进行规范化，将冗余数据和不必要的数据删除，以保证数据的一致性和完整性。
    
6.  设计索引：为表中经常用于查询的列创建索引，以提高查询效率。
    
7.  设计视图和存储过程：为方便用户使用和管理，可以为数据库设计视图和存储过程，以提高操作效率和数据安全性。
    

以上是数据库关系模型设计的主要步骤，设计出合理的关系模型能够提高数据库的效率和数据质量。



### 数据库的关系模式概念

数据库的关系模式指的是数据库中表格的结构和约束条件。它定义了表的列名、数据类型、主键、外键、索引、默认值、约束等信息，描述了表与表之间的关系和数据的完整性规则。关系模式通常由数据管理员或数据库设计人员设计和维护。

关系模式是数据库设计的核心，它决定了数据库的结构和操作方式。在关系模式中，每个表都有一个唯一的表名，每个列都有一个唯一的列名，并且每个列都有一个数据类型，例如整数、字符、日期等。表之间的关系可以通过主键和外键来建立，主键是唯一标识每个记录的列，而外键用于建立表与表之间的关系。

关系模式还包括约束条件，用于保证数据的完整性和正确性。例如，唯一约束条件可以保证某列中的值都是唯一的，而非空约束条件可以保证某列不为空。此外，还可以定义检查约束条件、默认值约束条件等。

总之，关系模式是数据库设计的基础，它定义了数据库中表格的结构和约束条件，是保证数据完整性和正确性的重要手段。






### 常见运行故障

1.  数据库死锁：当两个或多个事务在等待对方释放锁时，就会发生死锁。这会导致数据库停止响应，需要手动解锁才能恢复正常。
    
2.  数据库连接问题：当数据库连接出现问题时，应用程序无法访问数据库，这会导致应用程序崩溃或出现错误。连接问题可能是由于网络问题、数据库服务器故障或配置错误引起的。
    
3.  数据库备份和恢复问题：数据库备份和恢复是数据库管理员的重要任务。如果备份和恢复过程出现问题，可能会导致数据丢失或数据库无法正常运行。
    
4.  数据库性能问题：当数据库负载过重或查询效率低下时，可能会导致数据库性能下降。这会影响应用程序的响应时间和用户体验。
    
5.  数据库安全问题：数据库中存储着敏感数据，如果数据库安全性不足，可能会导致数据泄露或被黑客攻击。数据库管理员应该采取措施保护数据库安全。

### 存取权限管理

![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230317200411.png)
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230317195628.png)
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230317195717.png)

### 角色role

![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230317200033.png)
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230317200018.png)
![image.png](https://cdn.jsdelivr.net/gh/narugakuru/images/img/20230317200108.png)
